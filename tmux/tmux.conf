################################
# PREFIX
################################
unbind C-b
set -g prefix C-Space

unbind r
# Reload config with prefix + r
bind r source-file $XDG_CONFIG_HOME/tmux/tmux.conf \; display "Reloaded tmux conf"

################################
# GENERAL
################################
# Enable mouse support, xterm keys, and set a reasonable history limit.
# xterm-keys is needed for the cursor to work properly in Neovim when using tmux.
set -g mouse on
set -g xterm-keys on
set -g default-terminal "screen-256color"
set -g history-limit 10000
set -g repeat-time 0

################################
# SPLITS
################################
unbind %
unbind '"'

bind v split-window -h -c "#{pane_current_path}"
bind h split-window -v -c "#{pane_current_path}"

################################
# PANE NAVIGATION (NO PREFIX)
################################
#unbind -n C-Left
#unbind -n C-Right
#unbind -n C-Up
#unbind -n C-Down

#bind -n C-Left  select-pane -L
#bind -n C-Right select-pane -R
#bind -n C-Up    select-pane -U
#bind -n C-Down  select-pane -D

################################
# SMART CTRL+ARROW NAVIGATION
################################

is_vim="ps -o state= -o comm= -t '#{pane_tty}' \
    | grep -iqE '^[^TXZ ]+ +n?vim$'"

bind -n C-Left  if-shell "$is_vim" "send-keys C-Left"  "select-pane -L"
bind -n C-Right if-shell "$is_vim" "send-keys C-Right" "select-pane -R"
bind -n C-Up    if-shell "$is_vim" "send-keys C-Up"    "select-pane -U"
bind -n C-Down  if-shell "$is_vim" "send-keys C-Down"  "select-pane -D"


################################
# WINDOWS
################################
unbind n
unbind w

# Window renaming and creation
bind n command-prompt "rename-window '%%'"
bind w new-window -c "#{pane_current_path}"

# Window navigation (no prefix)
# Using Alt + left/right to navigate windows 
bind -n M-Left previous-window
bind -n M-Right next-window

################################
# SYNC / KILL
################################
# Toggle synchronized panes with prefix + Ctrl + s
bind s setw synchronize-panes\; display-message "synchronize-panes is now #{?pane_synchronized,on,off}"
bind -n C-F5 kill-pane

################################
# COPY MODE
################################
# Use Vi keybindings in copy mode, and set up yanking to system clipboard with xsel.
unbind -T copy-mode-vi Space
unbind -T copy-mode-vi Enter

bind -T copy-mode-vi v send-keys -X begin-selection
bind -T copy-mode-vi y send-keys -X copy-pipe-and-cancel "xsel --clipboard"

################################
# CURSOR FIX FOR NVIM
################################
# This is needed to fix the cursor shape in Neovim when using tmux. It sets the cursor shape to a block when in normal mode, and a beam when in insert mode.
set -g -a terminal-overrides ',*:Ss=\E[%p1%d q:Se=\E[2 q'

################################
# DESIGN
################################

# panes
#set -g pane-border-style fg=black,bg=black
#set -g pane-active-border-style fg=blue,bg=brightblack
# Set narrow border style (single-line thickness)
set -g pane-border-lines single

# Set border colors to a light orange
# 'colour214' or 'colour208' are standard 256-color light oranges
set -g pane-border-style fg=colour214
set -g pane-active-border-style fg=colour214



# status bar
set -g status-position bottom
set -g status-style bg=black,fg=yellow,dim
set -g status-left ''
set -g status-right '#{?client_prefix,#[fg=red]PREFIX ,#[fg=brightwhite]#H}'
set -g status-right-length 50

# windows
setw -g window-status-style fg=magenta,bg=black
setw -g window-status-current-style fg=red,bg=brightblack,bold
setw -g window-status-format ' #I:#W '
setw -g window-status-current-format ' #I:#W '

# silence
set -g visual-activity off
set -g visual-bell off
set -g visual-silence off
set -g bell-action none

################################
# TPM
################################
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-copycat'
set -g @plugin 'laktak/extrakto'

run -b "$XDG_CONFIG_HOME/tmux/plugins/tpm/tpm"

set -g @plugin 'christoomey/vim-tmux-navigator'
